


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > SpatialReferenceImpl</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.esri.core.geometry</a>
</div>

<h1>Coverage Summary for Class: SpatialReferenceImpl (com.esri.core.geometry)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SpatialReferenceImpl</td>
<td class="coverageStat">
  <span class="percent">
    56%
  </span>
  <span class="absValue">
    (14/25)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    75,6%
  </span>
  <span class="absValue">
    (96/127)
  </span>
</td>
</tr>
  <tr>
    <td class="name">SpatialReferenceImpl$Precision</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    53,8%
  </span>
  <span class="absValue">
    (14/26)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    74,4%
  </span>
  <span class="absValue">
    (96/129)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; Copyright 1995-2015 Esri
&nbsp;
&nbsp;   Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
&nbsp;   you may not use this file except in compliance with the License.
&nbsp;   You may obtain a copy of the License at
&nbsp;
&nbsp;       http://www.apache.org/licenses/LICENSE-2.0
&nbsp;
&nbsp;   Unless required by applicable law or agreed to in writing, software
&nbsp;   distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
&nbsp;   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
&nbsp;   See the License for the specific language governing permissions and
&nbsp;   limitations under the License.
&nbsp;
&nbsp; For additional information, contact:
&nbsp; Environmental Systems Research Institute, Inc.
&nbsp; Attn: Contracts Dept
&nbsp; 380 New York Street
&nbsp; Redlands, California, USA 92373
&nbsp;
&nbsp; email: contracts@esri.com
&nbsp; */
&nbsp;
&nbsp;package com.esri.core.geometry;
&nbsp;
&nbsp;import java.util.Arrays;
&nbsp;import java.util.concurrent.locks.ReentrantLock;
&nbsp;
<b class="nc">&nbsp;class SpatialReferenceImpl extends SpatialReference {</b>
&nbsp;	static final boolean no_projection_engine = true;
&nbsp;	public final static int c_SULIMIT32 = 2147483645;
&nbsp;	public final static long c_SULIMIT64 = 9007199254740990L;
&nbsp;
<b class="nc">&nbsp;	enum Precision {</b>
<b class="nc">&nbsp;		Integer32, Integer64, FloatingPoint</b>
&nbsp;	};
&nbsp;
&nbsp;	int m_userWkid;// this wkid is provided by user to the create method.
&nbsp;	int m_userLatestWkid;
&nbsp;	int m_userOldestWkid;
&nbsp;	String m_userWkt;// a string, the well-known text.
&nbsp;
&nbsp;	// public SgCoordRef m_sgCoordRef;
&nbsp;
<b class="fc">&nbsp;	private final static ReentrantLock m_lock = new ReentrantLock();</b>
&nbsp;
&nbsp;	// TODO If one was going to create member object for locking it would be
&nbsp;	// here.
<b class="fc">&nbsp;	SpatialReferenceImpl() {</b>
<b class="fc">&nbsp;		m_userWkid = 0;</b>
<b class="fc">&nbsp;		m_userLatestWkid = -1;</b>
<b class="fc">&nbsp;		m_userOldestWkid = -1;</b>
<b class="fc">&nbsp;		m_userWkt = null;</b>
&nbsp;	}
&nbsp;
&nbsp;	@Override
&nbsp;	public int getID() {
<b class="fc">&nbsp;		return m_userWkid;</b>
&nbsp;	}
&nbsp;
&nbsp;	double getFalseX() {
<b class="nc">&nbsp;		return 0;</b>
&nbsp;	}
&nbsp;
&nbsp;	double getFalseY() {
<b class="nc">&nbsp;		return 0;</b>
&nbsp;	}
&nbsp;
&nbsp;	double getFalseZ() {
<b class="nc">&nbsp;		return 0;</b>
&nbsp;	}
&nbsp;
&nbsp;	double getFalseM() {
<b class="nc">&nbsp;		return 0;</b>
&nbsp;	}
&nbsp;
&nbsp;	double getGridUnitsXY() {
<b class="nc">&nbsp;		return 1 / (1.0e-9 * 0.0174532925199433/* getOneDegreeGCSUnit() */);</b>
&nbsp;	}
&nbsp;
&nbsp;	double getGridUnitsZ() {
<b class="nc">&nbsp;		return 1 / 0.001;</b>
&nbsp;	}
&nbsp;
&nbsp;	double getGridUnitsM() {
<b class="nc">&nbsp;		return 1 / 0.001;</b>
&nbsp;	}
&nbsp;
&nbsp;	Precision getPrecision() {
<b class="nc">&nbsp;		return Precision.Integer64;</b>
&nbsp;	}
&nbsp;
&nbsp;	@Override
&nbsp;	double getTolerance(int semantics) {
<b class="fc">&nbsp;		double tolerance = 0.001;</b>
<b class="fc">&nbsp;		if (m_userWkid != 0) {</b>
<b class="fc">&nbsp;			tolerance = Wkid.find_tolerance_from_wkid(m_userWkid);</b>
<b class="fc">&nbsp;		} else if (m_userWkt != null) {</b>
<b class="nc">&nbsp;			tolerance = Wkt.find_tolerance_from_wkt(m_userWkt);</b>
&nbsp;		}
<b class="fc">&nbsp;		return tolerance;</b>
&nbsp;	}
&nbsp;
&nbsp;	public void queryValidCoordinateRange(Envelope2D env2D) {
<b class="nc">&nbsp;		double delta = 0;</b>
<b class="nc">&nbsp;		switch (getPrecision()) {</b>
&nbsp;		case Integer32:
<b class="nc">&nbsp;			delta = c_SULIMIT32 / getGridUnitsXY();</b>
<b class="nc">&nbsp;			break;</b>
&nbsp;		case Integer64:
<b class="nc">&nbsp;			delta = c_SULIMIT64 / getGridUnitsXY();</b>
<b class="nc">&nbsp;			break;</b>
&nbsp;		default:
&nbsp;			// TODO
<b class="nc">&nbsp;			throw GeometryException.GeometryInternalError();</b>
&nbsp;		}
&nbsp;
<b class="nc">&nbsp;		env2D.setCoords(getFalseX(), getFalseY(), getFalseX() + delta,</b>
<b class="nc">&nbsp;				getFalseY() + delta);</b>
&nbsp;	}
&nbsp;
&nbsp;	public boolean requiresReSimplify(SpatialReference dst) {
<b class="nc">&nbsp;		return dst != this;</b>
&nbsp;	}
&nbsp;
&nbsp;	@Override
&nbsp;	public String getText() {
<b class="fc">&nbsp;		return m_userWkt;</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Returns the oldest value of the well known ID for the horizontal
&nbsp;	 * coordinate system of the spatial reference. This ID is used for JSON
&nbsp;	 * serialization. Not public.
&nbsp;	 */
&nbsp;	@Override
&nbsp;	int getOldID() {
<b class="fc">&nbsp;		int ID_ = getID();</b>
&nbsp;
<b class="fc">&nbsp;		if (m_userOldestWkid != -1)</b>
<b class="fc">&nbsp;			return m_userOldestWkid;</b>
&nbsp;
<b class="fc">&nbsp;		m_userOldestWkid = Wkid.wkid_to_old(ID_);</b>
&nbsp;
<b class="fc">&nbsp;		if (m_userOldestWkid != -1)</b>
<b class="fc">&nbsp;			return m_userOldestWkid;</b>
&nbsp;
<b class="nc">&nbsp;		return ID_;</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Returns the latest value of the well known ID for the horizontal
&nbsp;	 * coordinate system of the spatial reference. This ID is used for JSON
&nbsp;	 * serialization. Not public.
&nbsp;	 */
&nbsp;	@Override
&nbsp;	int getLatestID() {
<b class="fc">&nbsp;		int ID_ = getID();</b>
&nbsp;
<b class="fc">&nbsp;		if (m_userLatestWkid != -1)</b>
<b class="fc">&nbsp;			return m_userLatestWkid;</b>
&nbsp;
<b class="fc">&nbsp;		m_userLatestWkid = Wkid.wkid_to_new(ID_);</b>
&nbsp;
<b class="fc">&nbsp;		if (m_userLatestWkid != -1)</b>
<b class="fc">&nbsp;			return m_userLatestWkid;</b>
&nbsp;
<b class="nc">&nbsp;		return ID_;</b>
&nbsp;	}
&nbsp;
&nbsp;	public static SpatialReferenceImpl createImpl(int wkid) {
<b class="fc">&nbsp;		if (wkid &lt;= 0)</b>
<b class="nc">&nbsp;			throw new IllegalArgumentException(&quot;Invalid or unsupported wkid: &quot;</b>
<b class="nc">&nbsp;					+ wkid);</b>
&nbsp;
<b class="fc">&nbsp;		SpatialReferenceImpl spatRef = new SpatialReferenceImpl();</b>
<b class="fc">&nbsp;		spatRef.m_userWkid = wkid;</b>
&nbsp;
<b class="fc">&nbsp;		return spatRef;</b>
&nbsp;	}
&nbsp;
&nbsp;	public static SpatialReferenceImpl createImpl(String wkt) {
<b class="fc">&nbsp;		if (wkt == null || wkt.length() == 0)</b>
<b class="nc">&nbsp;			throw new IllegalArgumentException(</b>
<b class="nc">&nbsp;					&quot;Cannot create SpatialReference from null or empty text.&quot;);</b>
&nbsp;
<b class="fc">&nbsp;		SpatialReferenceImpl spatRef = new SpatialReferenceImpl();</b>
<b class="fc">&nbsp;		spatRef.m_userWkt = wkt;</b>
&nbsp;
<b class="fc">&nbsp;		return spatRef;</b>
&nbsp;	}
&nbsp;
&nbsp;	@Override
&nbsp;	public boolean equals(Object obj) {
<b class="fc">&nbsp;		if (this == obj)</b>
<b class="fc">&nbsp;			return true;</b>
<b class="fc">&nbsp;		if (obj == null)</b>
<b class="nc">&nbsp;			return false;</b>
<b class="fc">&nbsp;		if (getClass() != obj.getClass())</b>
<b class="nc">&nbsp;			return false;</b>
&nbsp;
<b class="fc">&nbsp;		SpatialReferenceImpl sr = (SpatialReferenceImpl) obj;</b>
<b class="fc">&nbsp;		if (m_userWkid != sr.m_userWkid)</b>
<b class="fc">&nbsp;			return false;</b>
&nbsp;
<b class="fc">&nbsp;		if (m_userWkid == 0) {</b>
<b class="fc">&nbsp;			if (!m_userWkt.equals(sr.m_userWkt))// m_userWkt cannot be null here!</b>
<b class="fc">&nbsp;				return false;</b>
&nbsp;		}
&nbsp;
<b class="fc">&nbsp;		return true;</b>
&nbsp;	}
&nbsp;
&nbsp;	static double geodesicDistanceOnWGS84Impl(Point ptFrom, Point ptTo) {
<b class="fc">&nbsp;		double a = 6378137.0; // radius of spheroid for WGS_1984</b>
<b class="fc">&nbsp;		double e2 = 0.0066943799901413165; // ellipticity for WGS_1984</b>
<b class="fc">&nbsp;		double rpu = Math.PI / 180.0;</b>
<b class="fc">&nbsp;		PeDouble answer = new PeDouble();</b>
<b class="fc">&nbsp;		GeoDist.geodesic_distance_ngs(a, e2, ptFrom.getX() * rpu,</b>
<b class="fc">&nbsp;				ptFrom.getY() * rpu, ptTo.getX() * rpu, ptTo.getY()</b>
<b class="fc">&nbsp;						* rpu, answer, null, null);</b>
<b class="fc">&nbsp;		return answer.val;</b>
&nbsp;	}
&nbsp;
&nbsp;	public String getAuthority() {
<b class="fc">&nbsp;		int latestWKID = getLatestID();</b>
<b class="fc">&nbsp;		if (latestWKID &lt;= 0)</b>
<b class="nc">&nbsp;			return new String(&quot;&quot;);</b>
&nbsp;
<b class="fc">&nbsp;		return getAuthority_(latestWKID);</b>
&nbsp;	}
&nbsp;
&nbsp;	private String getAuthority_(int latestWKID) {
&nbsp;		String authority;
&nbsp;
<b class="fc">&nbsp;		if (latestWKID &gt;= 1024 &amp;&amp; latestWKID &lt;= 32767) {</b>
&nbsp;
<b class="fc">&nbsp;			int index = Arrays.binarySearch(m_esri_codes, latestWKID);</b>
&nbsp;
<b class="fc">&nbsp;			if (index &gt;= 0)</b>
<b class="nc">&nbsp;				authority = new String(&quot;ESRI&quot;);</b>
&nbsp;			else
<b class="fc">&nbsp;				authority = new String(&quot;EPSG&quot;);</b>
<b class="fc">&nbsp;		} else {</b>
<b class="fc">&nbsp;			authority = new String(&quot;ESRI&quot;);</b>
&nbsp;		}
&nbsp;
<b class="fc">&nbsp;		return authority;</b>
&nbsp;	}
&nbsp;
<b class="fc">&nbsp;	private static final int[] m_esri_codes = { </b>
<b class="fc">&nbsp;			2181, // ED_1950_Turkey_9</b>
<b class="fc">&nbsp;			2182, // ED_1950_Turkey_10</b>
<b class="fc">&nbsp;			2183, // ED_1950_Turkey_11</b>
<b class="fc">&nbsp;			2184, // ED_1950_Turkey_12</b>
<b class="fc">&nbsp;			2185, // ED_1950_Turkey_13</b>
<b class="fc">&nbsp;			2186, // ED_1950_Turkey_14</b>
<b class="fc">&nbsp;			2187, // ED_1950_Turkey_15</b>
<b class="fc">&nbsp;			4305, // GCS_Voirol_Unifie_1960</b>
<b class="fc">&nbsp;			4812, // GCS_Voirol_Unifie_1960_Paris</b>
<b class="fc">&nbsp;			20002, // Pulkovo_1995_GK_Zone_2</b>
<b class="fc">&nbsp;			20003, // Pulkovo_1995_GK_Zone_3</b>
<b class="fc">&nbsp;			20062, // Pulkovo_1995_GK_Zone_2N</b>
<b class="fc">&nbsp;			20063, // Pulkovo_1995_GK_Zone_3N</b>
<b class="fc">&nbsp;			24721, // La_Canoa_UTM_Zone_21N</b>
<b class="fc">&nbsp;			26761, // NAD_1927_StatePlane_Hawaii_1_FIPS_5101</b>
<b class="fc">&nbsp;			26762, // NAD_1927_StatePlane_Hawaii_2_FIPS_5102</b>
<b class="fc">&nbsp;			26763, // NAD_1927_StatePlane_Hawaii_3_FIPS_5103</b>
<b class="fc">&nbsp;			26764, // NAD_1927_StatePlane_Hawaii_4_FIPS_5104</b>
<b class="fc">&nbsp;			26765, // NAD_1927_StatePlane_Hawaii_5_FIPS_5105</b>
<b class="fc">&nbsp;			26788, // NAD_1927_StatePlane_Michigan_North_FIPS_2111</b>
<b class="fc">&nbsp;			26789, // NAD_1927_StatePlane_Michigan_Central_FIPS_2112</b>
<b class="fc">&nbsp;			26790, // NAD_1927_StatePlane_Michigan_South_FIPS_2113</b>
<b class="fc">&nbsp;			30591, // Nord_Algerie</b>
<b class="fc">&nbsp;			30592, // Sud_Algerie</b>
<b class="fc">&nbsp;			31491, // Germany_Zone_1</b>
<b class="fc">&nbsp;			31492, // Germany_Zone_2</b>
<b class="fc">&nbsp;			31493, // Germany_Zone_3</b>
<b class="fc">&nbsp;			31494, // Germany_Zone_4</b>
<b class="fc">&nbsp;			31495, // Germany_Zone_5</b>
<b class="fc">&nbsp;			32059, // NAD_1927_StatePlane_Puerto_Rico_FIPS_5201</b>
<b class="fc">&nbsp;			32060, // NAD_1927_StatePlane_Virgin_Islands_St_Croix_FIPS_5202</b>
&nbsp;	};
&nbsp;	
&nbsp;	@Override
&nbsp;	public int hashCode() {
<b class="fc">&nbsp;		if (m_userWkid != 0)</b>
<b class="fc">&nbsp;			return NumberUtils.hash(m_userWkid);</b>
&nbsp;
<b class="nc">&nbsp;		return m_userWkt.hashCode();</b>
&nbsp;	}	
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-02-21 15:02</div>
</div>
</body>
</html>
